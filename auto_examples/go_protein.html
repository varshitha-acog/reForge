

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Simple CG Protein &mdash; reForge 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=dc75d08a" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=01f34227"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="reForge API" href="../modules.html" />
    <link rel="prev" title="Hello World!" href="hello_world.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            reForge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../why.html">Why use reForge?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="hello_world.html">Hello World!</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Simple CG Protein</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">reForge API</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">reForge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Examples</a></li>
      <li class="breadcrumb-item active">Simple CG Protein</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/auto_examples/go_protein.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-go-protein-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code.</p>
</div>
<section class="sphx-glr-example-title" id="simple-cg-protein">
<span id="sphx-glr-auto-examples-go-protein-py"></span><h1>Simple CG Protein<a class="headerlink" href="#simple-cg-protein" title="Link to this heading"></a></h1>
<p>Simple Go-Martini setup</p>
<dl class="simple">
<dt>Requirements:</dt><dd><ul class="simple">
<li><p>GROMACS</p></li>
<li><p>Python 3.x</p></li>
</ul>
</dd>
</dl>
<p>Author: DY</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reforge</span><span class="w"> </span><span class="kn">import</span> <span class="n">cli</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">reforge.mdsystem.gmxmd</span><span class="w"> </span><span class="kn">import</span> <span class="n">GmxSystem</span><span class="p">,</span> <span class="n">GmxRun</span>
</pre></div>
</div>
<p>First, we need to initialize an instance of <em>GmxSystem</em>, which will handle path management
and the necessary files. This instance uses the parent directory <em>‘systems’</em> (relative to the current
directory) and the root directory <em>‘test’</em> within <em>‘systems’</em> for the system.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mdsys</span> <span class="o">=</span> <span class="n">GmxSystem</span><span class="p">(</span><span class="n">sysdir</span><span class="o">=</span><span class="s1">&#39;systems&#39;</span><span class="p">,</span> <span class="n">sysname</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, prepare the necessary file and directories by calling <em>prepare_files()</em>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mdsys</span><span class="o">.</span><span class="n">prepare_files</span><span class="p">()</span>

<span class="c1"># List the files in the system&#39;s root directory:</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">mdsys</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/scratch/dyangali/reforge/docs/examples/systems/test/nucleotides
/scratch/dyangali/reforge/docs/examples/systems/test/atommass.dat
/scratch/dyangali/reforge/docs/examples/systems/test/proteins
/scratch/dyangali/reforge/docs/examples/systems/test/png
/scratch/dyangali/reforge/docs/examples/systems/test/1btl.pdb
/scratch/dyangali/reforge/docs/examples/systems/test/water.gro
/scratch/dyangali/reforge/docs/examples/systems/test/topol
/scratch/dyangali/reforge/docs/examples/systems/test/protein.top
/scratch/dyangali/reforge/docs/examples/systems/test/data
/scratch/dyangali/reforge/docs/examples/systems/test/solute.pdb
/scratch/dyangali/reforge/docs/examples/systems/test/inpdb.pdb
/scratch/dyangali/reforge/docs/examples/systems/test/mdp
/scratch/dyangali/reforge/docs/examples/systems/test/map
/scratch/dyangali/reforge/docs/examples/systems/test/cgpdb
/scratch/dyangali/reforge/docs/examples/systems/test/system.top
</pre></div>
</div>
<p>Sort chains and atoms in the input PDB file to avoid future conflicts.
This creates a file (named <em>inpdb.pdb</em>) that can later be accessed as <em>mdsys.inpdb</em>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">in_pdb</span> <span class="o">=</span> <span class="n">mdsys</span><span class="o">.</span><span class="n">root</span> <span class="o">/</span> <span class="s2">&quot;1btl.pdb&quot;</span>  <span class="c1"># can be relative to *mdsys.root* or an absolute path</span>
<span class="n">mdsys</span><span class="o">.</span><span class="n">sort_input_pdb</span><span class="p">(</span><span class="n">in_pdb</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mdsys</span><span class="o">.</span><span class="n">inpdb</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Chains and atoms sorted, renamed and saved to /scratch/dyangali/reforge/docs/examples/systems/test/inpdb.pdb
/scratch/dyangali/reforge/docs/examples/systems/test/inpdb.pdb
</pre></div>
</div>
<p>Although there are multiple chains in this case, the <em>split_chains()</em> method
splits <em>mdsys.inpdb</em> into separate chains and moves protein and RNA/DNA files to their respective directories.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mdsys</span><span class="o">.</span><span class="n">split_chains</span><span class="p">()</span>
</pre></div>
</div>
<p>Coarse-grain the proteins using <em>martinize2</em> (by Martini):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mdsys</span><span class="o">.</span><span class="n">martinize_proteins_go</span><span class="p">(</span><span class="n">go_eps</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">go_low</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">go_up</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="s2">&quot;backbone&quot;</span><span class="p">,</span> <span class="n">pf</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">append</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/dyangali/.conda/envs/reforge/lib/python3.12/site-packages/MDAnalysis/topology/PDBParser.py:346: UserWarning: Unknown element  found for some atoms. These have been given an empty element record. If needed they can be guessed using universe.guess_TopologyAttrs(context=&#39;default&#39;, to_guess=[&#39;elements&#39;]).
  warnings.warn(wmsg)
</pre></div>
</div>
<p>Inspect the generated topology files. The topology should include the main protein topology file
<em>chain_A.itp</em> as well as the virtual sites parameters for the GO model:
<em>go_atomtypes.itp</em> and <em>go_nbparams.itp</em>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">mdsys</span><span class="o">.</span><span class="n">topdir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0_solvents_v1.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0_small_molecules_v2.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/go_nbparams.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0_ions_v1.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/chain_A.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/go_atomtypes.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0_phospholipids_v1.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_RNA.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0_rna.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_ions.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0_sugars_v2.itp
/scratch/dyangali/reforge/docs/examples/systems/test/topol/martini_v3.0.0_nucleobases_v1.itp
</pre></div>
</div>
<p>Check the coarse-grained structure in the <em>cgdir</em> directory.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">mdsys</span><span class="o">.</span><span class="n">cgdir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/scratch/dyangali/reforge/docs/examples/systems/test/cgpdb/chain_A.pdb
</pre></div>
</div>
<p>Combine all topology and structure files.
The method <em>make_cg_topology()</em> uses GROMACS’s <em>gmx pdb2gmx</em> module to create the simulation box.
(See online documentation for details.)</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mdsys</span><span class="o">.</span><span class="n">make_cg_topology</span><span class="p">()</span> <span class="c1"># It returns the CG topology as *mdsys.systop* (i.e. &quot;system.top&quot;).</span>
<span class="n">mdsys</span><span class="o">.</span><span class="n">make_cg_structure</span><span class="p">()</span> <span class="c1"># Returns *mdsys.solupdb* (i.e. &quot;solute.pdb&quot;).</span>
<span class="n">mdsys</span><span class="o">.</span><span class="n">make_box</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="n">bt</span><span class="o">=</span><span class="s1">&#39;dodecahedron&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Add solvent and neutralize the system’s charge.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">solvent</span> <span class="o">=</span> <span class="n">mdsys</span><span class="o">.</span><span class="n">root</span> <span class="o">/</span> <span class="s2">&quot;water.gro&quot;</span>
<span class="n">mdsys</span><span class="o">.</span><span class="n">solvate</span><span class="p">(</span><span class="n">cp</span><span class="o">=</span><span class="n">mdsys</span><span class="o">.</span><span class="n">solupdb</span><span class="p">,</span> <span class="n">cs</span><span class="o">=</span><span class="n">solvent</span><span class="p">)</span>
<span class="n">mdsys</span><span class="o">.</span><span class="n">add_bulk_ions</span><span class="p">(</span><span class="n">conc</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">pname</span><span class="o">=</span><span class="s2">&quot;NA&quot;</span><span class="p">,</span> <span class="n">nname</span><span class="o">=</span><span class="s2">&quot;CL&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>To work with GROMACS selections, generate an index file (<em>mdsys.sysndx</em>).
The default group order is: 1. <em>System</em>, 2. <em>Solute</em>, 3. <em>Backbone</em>, 4. <em>Solvent</em>, 5. <em>Not Water</em>, and then 6+ individual chains.
Custom groups can be added using the method <em>AtomList.write_to_ndx()</em>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mdsys</span><span class="o">.</span><span class="n">make_system_ndx</span><span class="p">(</span><span class="n">backbone_atoms</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;BB&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>One of the convenient features of <em>GmxSystem</em> is the ability to execute GROMACS commands
directly from your Python script using <em>GmxSystem.gmx</em>. This runs the command in the system’s working directory.
For example, to view the system (using VMD or PyMOL), you must first correct the generated box for
periodic boundary conditions. This is done with GROMACS’s <em>trjconv</em> module:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">mdsys</span><span class="o">.</span><span class="n">gmx</span><span class="p">(</span><span class="s2">&quot;trjconv&quot;</span><span class="p">,</span> <span class="n">clinput</span><span class="o">=</span><span class="s1">&#39;0</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">mdsys</span><span class="o">.</span><span class="n">syspdb</span><span class="p">,</span> <span class="n">f</span><span class="o">=</span><span class="n">mdsys</span><span class="o">.</span><span class="n">syspdb</span><span class="p">,</span> <span class="n">pbc</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">,</span> <span class="n">ur</span><span class="o">=</span><span class="s1">&#39;compact&#39;</span><span class="p">,</span> <span class="n">o</span><span class="o">=</span><span class="s2">&quot;viz.pdb&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 59.401 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-go-protein-py">
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/d519d4482f471d8e7e15f65f44a10fca/go_protein.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">go_protein.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/64f1b5cb8521d625198dd2770ca2ea14/go_protein.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">go_protein.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../_downloads/ca08e4d23ddfe42b7bb5a389babdcf69/go_protein.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">go_protein.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hello_world.html" class="btn btn-neutral float-left" title="Hello World!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../modules.html" class="btn btn-neutral float-right" title="reForge API" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Danis Yangaliev.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>