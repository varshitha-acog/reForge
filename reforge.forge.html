

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>reforge.forge package &mdash; reForge 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css?v=d2d258e8" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css?v=f4aeca0c" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css?v=2082cf3c" />
      <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css?v=1277b6f3" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=dc75d08a" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=01f34227"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="reforge.martini package" href="reforge.martini.html" />
    <link rel="prev" title="reforge package" href="reforge.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            reForge
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="why.html">Why use reForge?</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_examples/index.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">reForge API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="reforge.html">reforge package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="reforge.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">reforge.forge package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reforge.martini.html">reforge.martini package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reforge.mdsystem.html">reforge.mdsystem package</a></li>
<li class="toctree-l4"><a class="reference internal" href="reforge.rfgmath.html">reforge.rfgmath package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge.cli">reforge.cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge.io">reforge.io module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge.itpio">reforge.itpio module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge.mdm">reforge.mdm module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge.pdbtools">reforge.pdbtools module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge.plotting">reforge.plotting module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge.utils">reforge.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="reforge.html#module-reforge">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">reForge</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">reForge API</a></li>
          <li class="breadcrumb-item"><a href="reforge.html">reforge package</a></li>
      <li class="breadcrumb-item active">reforge.forge package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reforge.forge.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="reforge-forge-package">
<h1>reforge.forge package<a class="headerlink" href="#reforge-forge-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-reforge.forge.cgmap">
<span id="reforge-forge-cgmap-module"></span><h2>reforge.forge.cgmap module<a class="headerlink" href="#module-reforge.forge.cgmap" title="Link to this heading"></a></h2>
<p>CG mapping tools</p>
<dl class="simple">
<dt>Description:</dt><dd><p>Provides functions to map atomistic PDB data to a coarse-grained (CG)
representation.</p>
</dd>
</dl>
<p>Author: DY</p>
<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.cgmap.move_o3">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.cgmap.</span></span><span class="sig-name descname"><span class="pre">move_o3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">system</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/cgmap.html#move_o3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.cgmap.move_o3" title="Link to this definition"></a></dt>
<dd><p>Move each O3’ atom to the next residue. Needed for some CG nucleic
force fields due to the phosphate group mapping.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>system: A system object containing chains and residues.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.cgmap.map_residue">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.cgmap.</span></span><span class="sig-name descname"><span class="pre">map_residue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residue</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mapping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atid</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/cgmap.html#map_residue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.cgmap.map_residue" title="Link to this definition"></a></dt>
<dd><p>Map an atomistic residue to a coarse-grained (CG) residue.</p>
<p>For each bead defined in the mapping dictionary, this function creates a new bead atom.
The bead’s coordinates are determined by averaging the coordinates of the atoms in the
original residue that match the bead’s atom names.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>residue: The original residue object.
mapping (dict): Dictionary with bead names as keys and lists of atom names as values.
atid (int): Starting atom id to assign to new beads.</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of new bead atoms representing the coarse-grained residue.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.cgmap.map_chain">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.cgmap.</span></span><span class="sig-name descname"><span class="pre">map_chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/cgmap.html#map_chain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.cgmap.map_chain" title="Link to this definition"></a></dt>
<dd><p>Map a chain of atomistic residues to a coarse-grained (CG) representation.</p>
<p>For each residue in the chain, the function retrieves the corresponding bead mapping
from the force field (ff) based on the residue’s name. For the first residue, the mapping
for “BB1” is removed. Each residue is then converted to its CG representation using the
map_residue function, and the resulting beads are collected into a single list.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>chain: List of residue objects.
ff: Force field object that contains a ‘mapping’ dictionary keyed by residue name.
atid (int): Starting atom id for new beads (default is 1).</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of coarse-grained bead atoms representing the entire chain.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.cgmap.map_model">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.cgmap.</span></span><span class="sig-name descname"><span class="pre">map_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/cgmap.html#map_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.cgmap.map_model" title="Link to this definition"></a></dt>
<dd><p>Map a model of atomistic residues to a coarse-grained (CG) representation.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>model: Iterable of chains (each a list of residue objects).
ff: Force field object containing a ‘mapping’ dictionary keyed by residue name.
atid (int): Starting atom id for new beads (default is 1).</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of coarse-grained bead atoms representing the entire model.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-reforge.forge.forcefields">
<span id="reforge-forge-forcefields-module"></span><h2>reforge.forge.forcefields module<a class="headerlink" href="#module-reforge.forge.forcefields" title="Link to this heading"></a></h2>
<p>Collection of CG force fields</p>
<dl class="simple">
<dt>Description:</dt><dd><p>This module defines force fields for Martini RNA and nucleic acids.
It provides classes for reading ITP files and organizing force-field parameters
for coarse-grained simulations.</p>
</dd>
</dl>
<p>Author: DY</p>
<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.forcefields.nsplit">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.forcefields.</span></span><span class="sig-name descname"><span class="pre">nsplit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#nsplit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.nsplit" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reforge.forge.forcefields.</span></span><span class="sig-name descname"><span class="pre">NucleicForceField</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for nucleic acid force fields.</p>
<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.read_itp">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_itp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.read_itp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.read_itp" title="Link to this definition"></a></dt>
<dd><p>Read an ITP file for a given residue.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>resname (str): Residue name.
directory (str): Directory where force field files are stored.
mol (str): Molecule name.
version (str): Version string.</p>
</dd>
<dt>Returns:</dt><dd><p>dict: Parsed ITP data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.read_itps">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read_itps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.read_itps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.read_itps" title="Link to this definition"></a></dt>
<dd><p>Read ITP files for nucleobases A, C, G, and U.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>mol (str): Molecule name.
ff_type (str): Force-field type (e.g. “polar”).
version (str): Version string.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (a_itp, c_itp, g_itp, u_itp)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.itp_to_indata">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">itp_to_indata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">itp_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.itp_to_indata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.itp_to_indata" title="Link to this definition"></a></dt>
<dd><p>Convert ITP data into individual parameter lists.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>itp_data (dict): Parsed ITP file data.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: (sc_bonds, sc_angles, sc_dihs, sc_cons, sc_excls, sc_pairs, sc_vs3s)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.parameters_by_resname">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">parameters_by_resname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resnames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.parameters_by_resname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.parameters_by_resname" title="Link to this definition"></a></dt>
<dd><p>Obtain parameters for each residue.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>resnames (list): List of residue names.
directory (str): Directory containing ITP files.
mol (str): Molecule name.
version (str): Version string.</p>
</dd>
<dt>Returns:</dt><dd><p>dict: Mapping of residue name to its parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_bonds">
<span class="sig-name descname"><span class="pre">sc_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_bonds" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_angles">
<span class="sig-name descname"><span class="pre">sc_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_angles" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_dihs">
<span class="sig-name descname"><span class="pre">sc_dihs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_dihs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_dihs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_cons">
<span class="sig-name descname"><span class="pre">sc_cons</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_cons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_cons" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_excls">
<span class="sig-name descname"><span class="pre">sc_excls</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_excls"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_excls" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_pairs">
<span class="sig-name descname"><span class="pre">sc_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_pairs" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_vs3s">
<span class="sig-name descname"><span class="pre">sc_vs3s</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_vs3s"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_vs3s" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.NucleicForceField.sc_blist">
<span class="sig-name descname"><span class="pre">sc_blist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#NucleicForceField.sc_blist"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.NucleicForceField.sc_blist" title="Link to this definition"></a></dt>
<dd><p>Get all bonded parameters for a residue.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>resname (str): Residue name.</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of bonded parameter lists.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reforge.forge.forcefields.</span></span><span class="sig-name descname"><span class="pre">Martini30RNA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'rna_reg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'new'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#Martini30RNA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reforge.forge.forcefields.NucleicForceField" title="reforge.forge.forcefields.NucleicForceField"><code class="xref py py-class docutils literal notranslate"><span class="pre">NucleicForceField</span></code></a></p>
<p>Force field for Martini 3.0 RNA.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.resnames">
<span class="sig-name descname"><span class="pre">resnames</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['A',</span> <span class="pre">'C',</span> <span class="pre">'G',</span> <span class="pre">'U']</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.resnames" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.bb_mapping">
<span class="sig-name descname"><span class="pre">bb_mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'BB1':</span> <span class="pre">('P',</span> <span class="pre">'OP1',</span> <span class="pre">'OP2',</span> <span class="pre">&quot;O5'&quot;,</span> <span class="pre">&quot;O3'&quot;,</span> <span class="pre">'O1P',</span> <span class="pre">'O2P'),</span> <span class="pre">'BB2':</span> <span class="pre">(&quot;C5'&quot;,</span> <span class="pre">&quot;1H5'&quot;,</span> <span class="pre">&quot;2H5'&quot;,</span> <span class="pre">&quot;H5'&quot;,</span> <span class="pre">&quot;H5''&quot;,</span> <span class="pre">&quot;C4'&quot;,</span> <span class="pre">&quot;H4'&quot;,</span> <span class="pre">&quot;O4'&quot;,</span> <span class="pre">&quot;C3'&quot;,</span> <span class="pre">&quot;H3'&quot;),</span> <span class="pre">'BB3':</span> <span class="pre">(&quot;C1'&quot;,</span> <span class="pre">&quot;C2'&quot;,</span> <span class="pre">&quot;O2'&quot;,</span> <span class="pre">&quot;O4'&quot;)}</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.bb_mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.a_mapping">
<span class="sig-name descname"><span class="pre">a_mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'SC1':</span> <span class="pre">('N9',</span> <span class="pre">'C8',</span> <span class="pre">'H8'),</span> <span class="pre">'SC2':</span> <span class="pre">('N3',</span> <span class="pre">'C4'),</span> <span class="pre">'SC3':</span> <span class="pre">('N1',</span> <span class="pre">'C2',</span> <span class="pre">'H2'),</span> <span class="pre">'SC4':</span> <span class="pre">('N6',</span> <span class="pre">'C6',</span> <span class="pre">'H61',</span> <span class="pre">'H62'),</span> <span class="pre">'SC5':</span> <span class="pre">('N7',</span> <span class="pre">'C5')}</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.a_mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.c_mapping">
<span class="sig-name descname"><span class="pre">c_mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'SC1':</span> <span class="pre">('N1',</span> <span class="pre">'C5',</span> <span class="pre">'C6'),</span> <span class="pre">'SC2':</span> <span class="pre">('C2',</span> <span class="pre">'O2'),</span> <span class="pre">'SC3':</span> <span class="pre">('N3',),</span> <span class="pre">'SC4':</span> <span class="pre">('N4',</span> <span class="pre">'C4',</span> <span class="pre">'H41',</span> <span class="pre">'H42')}</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.c_mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.g_mapping">
<span class="sig-name descname"><span class="pre">g_mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'SC1':</span> <span class="pre">('C8',</span> <span class="pre">'H8',</span> <span class="pre">'N9'),</span> <span class="pre">'SC2':</span> <span class="pre">('C4',</span> <span class="pre">'N3'),</span> <span class="pre">'SC3':</span> <span class="pre">('C2',</span> <span class="pre">'N2',</span> <span class="pre">'H21',</span> <span class="pre">'H22'),</span> <span class="pre">'SC4':</span> <span class="pre">('N1',),</span> <span class="pre">'SC5':</span> <span class="pre">('C6',</span> <span class="pre">'O6'),</span> <span class="pre">'SC6':</span> <span class="pre">('C5',</span> <span class="pre">'N7')}</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.g_mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.u_mapping">
<span class="sig-name descname"><span class="pre">u_mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'SC1':</span> <span class="pre">('N1',</span> <span class="pre">'C5',</span> <span class="pre">'C6'),</span> <span class="pre">'SC2':</span> <span class="pre">('C2',</span> <span class="pre">'O2'),</span> <span class="pre">'SC3':</span> <span class="pre">('N3',),</span> <span class="pre">'SC4':</span> <span class="pre">('C4',</span> <span class="pre">'O4')}</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.u_mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.mapping">
<span class="sig-name descname"><span class="pre">mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'A':</span> <span class="pre">{'BB1':</span> <span class="pre">('P',</span> <span class="pre">'OP1',</span> <span class="pre">'OP2',</span> <span class="pre">&quot;O5'&quot;,</span> <span class="pre">&quot;O3'&quot;,</span> <span class="pre">'O1P',</span> <span class="pre">'O2P'),</span> <span class="pre">'BB2':</span> <span class="pre">(&quot;C5'&quot;,</span> <span class="pre">&quot;1H5'&quot;,</span> <span class="pre">&quot;2H5'&quot;,</span> <span class="pre">&quot;H5'&quot;,</span> <span class="pre">&quot;H5''&quot;,</span> <span class="pre">&quot;C4'&quot;,</span> <span class="pre">&quot;H4'&quot;,</span> <span class="pre">&quot;O4'&quot;,</span> <span class="pre">&quot;C3'&quot;,</span> <span class="pre">&quot;H3'&quot;),</span> <span class="pre">'BB3':</span> <span class="pre">(&quot;C1'&quot;,</span> <span class="pre">&quot;C2'&quot;,</span> <span class="pre">&quot;O2'&quot;,</span> <span class="pre">&quot;O4'&quot;),</span> <span class="pre">'SC1':</span> <span class="pre">('N9',</span> <span class="pre">'C8',</span> <span class="pre">'H8'),</span> <span class="pre">'SC2':</span> <span class="pre">('N3',</span> <span class="pre">'C4'),</span> <span class="pre">'SC3':</span> <span class="pre">('N1',</span> <span class="pre">'C2',</span> <span class="pre">'H2'),</span> <span class="pre">'SC4':</span> <span class="pre">('N6',</span> <span class="pre">'C6',</span> <span class="pre">'H61',</span> <span class="pre">'H62'),</span> <span class="pre">'SC5':</span> <span class="pre">('N7',</span> <span class="pre">'C5')},</span> <span class="pre">'C':</span> <span class="pre">{'BB1':</span> <span class="pre">('P',</span> <span class="pre">'OP1',</span> <span class="pre">'OP2',</span> <span class="pre">&quot;O5'&quot;,</span> <span class="pre">&quot;O3'&quot;,</span> <span class="pre">'O1P',</span> <span class="pre">'O2P'),</span> <span class="pre">'BB2':</span> <span class="pre">(&quot;C5'&quot;,</span> <span class="pre">&quot;1H5'&quot;,</span> <span class="pre">&quot;2H5'&quot;,</span> <span class="pre">&quot;H5'&quot;,</span> <span class="pre">&quot;H5''&quot;,</span> <span class="pre">&quot;C4'&quot;,</span> <span class="pre">&quot;H4'&quot;,</span> <span class="pre">&quot;O4'&quot;,</span> <span class="pre">&quot;C3'&quot;,</span> <span class="pre">&quot;H3'&quot;),</span> <span class="pre">'BB3':</span> <span class="pre">(&quot;C1'&quot;,</span> <span class="pre">&quot;C2'&quot;,</span> <span class="pre">&quot;O2'&quot;,</span> <span class="pre">&quot;O4'&quot;),</span> <span class="pre">'SC1':</span> <span class="pre">('N1',</span> <span class="pre">'C5',</span> <span class="pre">'C6'),</span> <span class="pre">'SC2':</span> <span class="pre">('C2',</span> <span class="pre">'O2'),</span> <span class="pre">'SC3':</span> <span class="pre">('N3',),</span> <span class="pre">'SC4':</span> <span class="pre">('N4',</span> <span class="pre">'C4',</span> <span class="pre">'H41',</span> <span class="pre">'H42')},</span> <span class="pre">'G':</span> <span class="pre">{'BB1':</span> <span class="pre">('P',</span> <span class="pre">'OP1',</span> <span class="pre">'OP2',</span> <span class="pre">&quot;O5'&quot;,</span> <span class="pre">&quot;O3'&quot;,</span> <span class="pre">'O1P',</span> <span class="pre">'O2P'),</span> <span class="pre">'BB2':</span> <span class="pre">(&quot;C5'&quot;,</span> <span class="pre">&quot;1H5'&quot;,</span> <span class="pre">&quot;2H5'&quot;,</span> <span class="pre">&quot;H5'&quot;,</span> <span class="pre">&quot;H5''&quot;,</span> <span class="pre">&quot;C4'&quot;,</span> <span class="pre">&quot;H4'&quot;,</span> <span class="pre">&quot;O4'&quot;,</span> <span class="pre">&quot;C3'&quot;,</span> <span class="pre">&quot;H3'&quot;),</span> <span class="pre">'BB3':</span> <span class="pre">(&quot;C1'&quot;,</span> <span class="pre">&quot;C2'&quot;,</span> <span class="pre">&quot;O2'&quot;,</span> <span class="pre">&quot;O4'&quot;),</span> <span class="pre">'SC1':</span> <span class="pre">('C8',</span> <span class="pre">'H8',</span> <span class="pre">'N9'),</span> <span class="pre">'SC2':</span> <span class="pre">('C4',</span> <span class="pre">'N3'),</span> <span class="pre">'SC3':</span> <span class="pre">('C2',</span> <span class="pre">'N2',</span> <span class="pre">'H21',</span> <span class="pre">'H22'),</span> <span class="pre">'SC4':</span> <span class="pre">('N1',),</span> <span class="pre">'SC5':</span> <span class="pre">('C6',</span> <span class="pre">'O6'),</span> <span class="pre">'SC6':</span> <span class="pre">('C5',</span> <span class="pre">'N7')},</span> <span class="pre">'U':</span> <span class="pre">{'BB1':</span> <span class="pre">('P',</span> <span class="pre">'OP1',</span> <span class="pre">'OP2',</span> <span class="pre">&quot;O5'&quot;,</span> <span class="pre">&quot;O3'&quot;,</span> <span class="pre">'O1P',</span> <span class="pre">'O2P'),</span> <span class="pre">'BB2':</span> <span class="pre">(&quot;C5'&quot;,</span> <span class="pre">&quot;1H5'&quot;,</span> <span class="pre">&quot;2H5'&quot;,</span> <span class="pre">&quot;H5'&quot;,</span> <span class="pre">&quot;H5''&quot;,</span> <span class="pre">&quot;C4'&quot;,</span> <span class="pre">&quot;H4'&quot;,</span> <span class="pre">&quot;O4'&quot;,</span> <span class="pre">&quot;C3'&quot;,</span> <span class="pre">&quot;H3'&quot;),</span> <span class="pre">'BB3':</span> <span class="pre">(&quot;C1'&quot;,</span> <span class="pre">&quot;C2'&quot;,</span> <span class="pre">&quot;O2'&quot;,</span> <span class="pre">&quot;O4'&quot;),</span> <span class="pre">'SC1':</span> <span class="pre">('N1',</span> <span class="pre">'C5',</span> <span class="pre">'C6'),</span> <span class="pre">'SC2':</span> <span class="pre">('C2',</span> <span class="pre">'O2'),</span> <span class="pre">'SC3':</span> <span class="pre">('N3',),</span> <span class="pre">'SC4':</span> <span class="pre">('C4',</span> <span class="pre">'O4')}}</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini30RNA.sc_atoms">
<span class="sig-name descname"><span class="pre">sc_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#Martini30RNA.sc_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.Martini30RNA.sc_atoms" title="Link to this definition"></a></dt>
<dd><p>Return side-chain atoms for the given residue.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini31Nucleic">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reforge.forge.forcefields.</span></span><span class="sig-name descname"><span class="pre">Martini31Nucleic</span></span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#Martini31Nucleic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.Martini31Nucleic" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#reforge.forge.forcefields.NucleicForceField" title="reforge.forge.forcefields.NucleicForceField"><code class="xref py py-class docutils literal notranslate"><span class="pre">NucleicForceField</span></code></a></p>
<p>Force field for Martini 3.1 nucleic acids.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini31Nucleic.bb_mapping">
<span class="sig-name descname"><span class="pre">bb_mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[['P',</span> <span class="pre">'OP1',</span> <span class="pre">'OP2',</span> <span class="pre">&quot;O5'&quot;,</span> <span class="pre">&quot;O3'&quot;,</span> <span class="pre">'O1P',</span> <span class="pre">'O2P'],</span> <span class="pre">[&quot;C5'&quot;,</span> <span class="pre">&quot;1H5'&quot;,</span> <span class="pre">&quot;2H5'&quot;,</span> <span class="pre">&quot;H5'&quot;,</span> <span class="pre">&quot;H5''&quot;,</span> <span class="pre">&quot;C4'&quot;,</span> <span class="pre">&quot;H4'&quot;,</span> <span class="pre">&quot;O4'&quot;,</span> <span class="pre">&quot;C3'&quot;,</span> <span class="pre">&quot;H3'&quot;],</span> <span class="pre">[&quot;C1'&quot;,</span> <span class="pre">&quot;C2'&quot;,</span> <span class="pre">&quot;O2'&quot;,</span> <span class="pre">&quot;O4'&quot;]]</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini31Nucleic.bb_mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini31Nucleic.mapping">
<span class="sig-name descname"><span class="pre">mapping</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">{'A':</span> <span class="pre">{'SC1':</span> <span class="pre">['TA1',</span> <span class="pre">'TA2',</span> <span class="pre">'TA3',</span> <span class="pre">'TA4',</span> <span class="pre">'TA5',</span> <span class="pre">'TA6']},</span> <span class="pre">'C':</span> <span class="pre">{'SC1':</span> <span class="pre">['TY1',</span> <span class="pre">'TY2',</span> <span class="pre">'TY3',</span> <span class="pre">'TY4',</span> <span class="pre">'TY5']},</span> <span class="pre">'G':</span> <span class="pre">{'SC1':</span> <span class="pre">['TG1',</span> <span class="pre">'TG2',</span> <span class="pre">'TG3',</span> <span class="pre">'TG4',</span> <span class="pre">'TG5',</span> <span class="pre">'TG6',</span> <span class="pre">'TG7',</span> <span class="pre">'TG8']},</span> <span class="pre">'U':</span> <span class="pre">{'SC1':</span> <span class="pre">['TU1',</span> <span class="pre">'TU2',</span> <span class="pre">'TU3',</span> <span class="pre">'TU4',</span> <span class="pre">'TU5',</span> <span class="pre">'TU6',</span> <span class="pre">'TU7']}}</span></em><a class="headerlink" href="#reforge.forge.forcefields.Martini31Nucleic.mapping" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.forcefields.Martini31Nucleic.sc_atoms">
<span class="sig-name descname"><span class="pre">sc_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">resname</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/forcefields.html#Martini31Nucleic.sc_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.forcefields.Martini31Nucleic.sc_atoms" title="Link to this definition"></a></dt>
<dd><p>Return side-chain atoms for a given residue.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-reforge.forge.geometry">
<span id="reforge-forge-geometry-module"></span><h2>reforge.forge.geometry module<a class="headerlink" href="#module-reforge.forge.geometry" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Description:</dt><dd><p>Provides geometric calculations (distances, angles, dihedrals) for coarse-grained
systems and functions to compute bond lists from a system (using a reference topology).</p>
</dd>
</dl>
<p>Author: DY</p>
<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.get_distance">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">get_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#get_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.get_distance" title="Link to this definition"></a></dt>
<dd><p>Compute the Euclidean distance between two vectors (returned in nanometers).</p>
<dl class="simple">
<dt>Args:</dt><dd><p>v1: First vector (list or array-like).
v2: Second vector (list or array-like).</p>
</dd>
<dt>Returns:</dt><dd><p>float: Distance between v1 and v2 divided by 10.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.get_angle">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">get_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#get_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.get_angle" title="Link to this definition"></a></dt>
<dd><p>Calculate the angle at vertex v2 (in degrees) given three points.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>v1: First vector (list or array-like).
v2: Vertex vector (list or array-like).
v3: Third vector (list or array-like).</p>
</dd>
<dt>Returns:</dt><dd><p>float: Angle in degrees.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.get_dihedral">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">get_dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v4</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#get_dihedral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.get_dihedral" title="Link to this definition"></a></dt>
<dd><p>Calculate the dihedral angle (in degrees) defined by four points.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>v1: First vector.
v2: Second vector.
v3: Third vector.
v4: Fourth vector.</p>
</dd>
<dt>Returns:</dt><dd><p>float: Dihedral angle in degrees.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.calc_bonds">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">calc_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bonds</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#calc_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.calc_bonds" title="Link to this definition"></a></dt>
<dd><p>Calculate bond distances from a topology bonds object and a list of atoms.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>atoms: List of atom objects.
bonds: Topology bonds object with attributes ‘conns’, ‘params’, and ‘comms’.</p>
</dd>
<dt>Returns:</dt><dd><p>BondList: A list of bonds with computed distances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.calc_angles">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">calc_angles</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angles</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#calc_angles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.calc_angles" title="Link to this definition"></a></dt>
<dd><p>Calculate bond angles from a topology angles object and a list of atoms.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>atoms: List of atom objects.
angles: Topology angles object with attributes ‘conns’, ‘params’, and ‘comms’.</p>
</dd>
<dt>Returns:</dt><dd><p>BondList: A list of angles with computed values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.calc_dihedrals">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">calc_dihedrals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dihs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#calc_dihedrals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.calc_dihedrals" title="Link to this definition"></a></dt>
<dd><p>Calculate dihedral angles from a topology dihedrals object and a list of atoms.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>atoms: List of atom objects.
dihs: Topology dihedrals object with attributes ‘conns’, ‘params’, and ‘comms’.</p>
</dd>
<dt>Returns:</dt><dd><p>BondList: A list of dihedrals with computed values.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.get_cg_bonds">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">get_cg_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inpdb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#get_cg_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.get_cg_bonds" title="Link to this definition"></a></dt>
<dd><p>Calculate bonds, angles, and dihedrals for a coarse-grained system.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>inpdb (str): Input PDB file for the coarse-grained system.
top: Topology object containing bond, angle, and dihedral definitions.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: Three BondList objects: (bonds, angles, dihedrals).</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.geometry.get_aa_bonds">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.geometry.</span></span><span class="sig-name descname"><span class="pre">get_aa_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">inpdb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/geometry.html#get_aa_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.geometry.get_aa_bonds" title="Link to this definition"></a></dt>
<dd><p>Calculate bonds, angles, and dihedrals for an all-atom system.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>inpdb (str): Input PDB file for the all-atom system.
ff: Force field object.
top: Topology object containing reference bonds, angles, and dihedrals.</p>
</dd>
<dt>Returns:</dt><dd><p>tuple: Three BondList objects: (bonds, angles, dihedrals).</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-reforge.forge.persistence_length">
<span id="reforge-forge-persistence-length-module"></span><h2>reforge.forge.persistence_length module<a class="headerlink" href="#module-reforge.forge.persistence_length" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>Description:</dt><dd><p>This module computes the persistence length of a nucleic acid system by
calculating angles between consecutive bond vectors in a coarse-grained model.
It provides functions to read a structure from a PDB file, compute geometric
measures (angles, rotation matrices), and finally plot the average angles.</p>
</dd>
</dl>
<p>Author: DY</p>
<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.get_structure_cif">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">get_structure_cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'path/to/cif'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#get_structure_cif"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.get_structure_cif" title="Link to this definition"></a></dt>
<dd><p>Read a structure from a CIF file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>cif_id (str): Path to the CIF file.</p>
</dd>
<dt>Returns:</dt><dd><p>structure: A Bio.PDB structure object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.get_structure_pdb">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">get_structure_pdb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pdb_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'path/to/pdb'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#get_structure_pdb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.get_structure_pdb" title="Link to this definition"></a></dt>
<dd><p>Read a structure from a PDB file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>pdb_id (str): Path to the PDB file.</p>
</dd>
<dt>Returns:</dt><dd><p>structure: A Bio.PDB structure object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.get_residues">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">get_residues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#get_residues"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.get_residues" title="Link to this definition"></a></dt>
<dd><p>Extract all residues from a model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model: A Bio.PDB model object.</p>
</dd>
<dt>Returns:</dt><dd><p>list: A list of residue objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.get_resid">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">get_resid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residue</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#get_resid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.get_resid" title="Link to this definition"></a></dt>
<dd><p>Extract the residue id from the string representation of a residue.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>residue: A Bio.PDB residue object.</p>
</dd>
<dt>Returns:</dt><dd><p>int: The residue id.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.get_atoms_by_name">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">get_atoms_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">residues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BB3'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#get_atoms_by_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.get_atoms_by_name" title="Link to this definition"></a></dt>
<dd><p>Select atoms with a given name from a list of residues.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>residues (list): List of residue objects.
atom_name (str): Name of the atom to select (default “BB3”).</p>
</dd>
<dt>Returns:</dt><dd><dl class="simple">
<dt>tuple: A tuple (atoms, resids) where atoms is a list of matching atom objects,</dt><dd><p>and resids is a list of corresponding residue ids.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.get_coords">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">get_coords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#get_coords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.get_coords" title="Link to this definition"></a></dt>
<dd><p>Get the coordinates for a list of atoms.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>atoms (list): List of atom objects.</p>
</dd>
<dt>Returns:</dt><dd><p>list: List of coordinate arrays.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.get_angle">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">get_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#get_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.get_angle" title="Link to this definition"></a></dt>
<dd><p>Compute the angle (in degrees) between two vectors.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>v1: First vector.
v2: Second vector.</p>
</dd>
<dt>Returns:</dt><dd><p>float: Angle in degrees.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.rotation_matrix_from_vectors">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">rotation_matrix_from_vectors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vec1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vec2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#rotation_matrix_from_vectors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.rotation_matrix_from_vectors" title="Link to this definition"></a></dt>
<dd><p>Find the rotation matrix that aligns vec1 to vec2.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>vec1 (array-like): Source vector.
vec2 (array-like): Destination vector.</p>
</dd>
<dt>Returns:</dt><dd><p>np.ndarray: A 3x3 rotation matrix.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.persistence_length">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">persistence_length</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#persistence_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.persistence_length" title="Link to this definition"></a></dt>
<dd><p>Calculate and plot the persistence length from a structure.</p>
<p>For each model in the structure, the function computes the angle between
bond vectors (taken from atoms with name “BB3”) after aligning them with
a reference vector. The average angles are then plotted and saved to a file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>structure: A Bio.PDB structure object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.test_rmats">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">test_rmats</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#test_rmats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.test_rmats" title="Link to this definition"></a></dt>
<dd><p>Test function for rotation_matrix_from_vectors.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="reforge.forge.persistence_length.main">
<span class="sig-prename descclassname"><span class="pre">reforge.forge.persistence_length.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/persistence_length.html#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.persistence_length.main" title="Link to this definition"></a></dt>
<dd><p>Main function to compute persistence length.</p>
</dd></dl>

</section>
<section id="module-reforge.forge.topology">
<span id="reforge-forge-topology-module"></span><h2>reforge.forge.topology module<a class="headerlink" href="#module-reforge.forge.topology" title="Link to this heading"></a></h2>
<p>Topology Module</p>
<dl>
<dt>Description:</dt><dd><p>This module provides classes and functions to construct a coarse-grained
topology from force field parameters. It defines the Topology class along with
a helper BondList class. Methods are provided to process atoms, bonds, and
connectivity information, and to generate topology files for coarse-grained
simulations.</p>
</dd>
<dt>Usage Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">topology</span><span class="w"> </span><span class="kn">import</span> <span class="n">Topology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">reforge.forcefield</span><span class="w"> </span><span class="kn">import</span> <span class="n">NucleicForceField</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ff</span> <span class="o">=</span> <span class="n">NucleicForceField</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># Initialize the force field instance</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topo</span> <span class="o">=</span> <span class="n">Topology</span><span class="p">(</span><span class="n">ff</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topo</span><span class="o">.</span><span class="n">from_sequence</span><span class="p">([</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;G&#39;</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">topo</span><span class="o">.</span><span class="n">write_to_itp</span><span class="p">(</span><span class="s1">&#39;output.itp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd>
<dt>Requirements:</dt><dd><ul class="simple">
<li><p>Python 3.x</p></li>
<li><p>NumPy</p></li>
<li><p>reForge utilities and force field modules</p></li>
</ul>
</dd>
</dl>
<p>Author: DY
Date: YYYY-MM-DD</p>
<dl class="py class">
<dt class="sig sig-object py" id="reforge.forge.topology.BondList">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reforge.forge.topology.</span></span><span class="sig-name descname"><span class="pre">BondList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iterable</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em>, <em class="sig-param"><span class="positional-only-separator o"><abbr title="Positional-only parameter separator (PEP 570)"><span class="pre">/</span></abbr></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#BondList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.BondList" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></p>
<p>BondList Class</p>
<dl class="simple">
<dt>Description:</dt><dd><p>A helper subclass of the built-in list for storing bond information.
Each element represents a bond in the form [connectivity, parameters, comment].</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>list</strong><strong>)</strong> (<em>(</em><em>inherited from</em>) – Holds individual bond representations.</p></li>
<li><p><strong>Example</strong> (<em>Usage</em>) – <div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bonds</span> <span class="o">=</span> <span class="n">BondList</span><span class="p">([[</span><span class="s1">&#39;C1-C2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="s1">&#39;res1 bead1&#39;</span><span class="p">],</span>
<span class="gp">... </span>                  <span class="p">[</span><span class="s1">&#39;C2-O1&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">],</span> <span class="s1">&#39;res2 bead2&#39;</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bonds</span><span class="o">.</span><span class="n">conns</span><span class="p">)</span>
<span class="go">[&#39;C1-C2&#39;, &#39;C2-O1&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bonds</span><span class="o">.</span><span class="n">conns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C1-C2_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;C2-O1_mod&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">bonds</span><span class="o">.</span><span class="n">conns</span><span class="p">)</span>
<span class="go">[&#39;C1-C2_mod&#39;, &#39;C2-O1_mod&#39;]</span>
</pre></div>
</div>
</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="reforge.forge.topology.BondList.conns">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">conns</span></span><a class="headerlink" href="#reforge.forge.topology.BondList.conns" title="Link to this definition"></a></dt>
<dd><p>Get connectivity values from each bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of connectivity values (index 0 of each bond).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reforge.forge.topology.BondList.params">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#reforge.forge.topology.BondList.params" title="Link to this definition"></a></dt>
<dd><p>Get parameters from each bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of parameter values (index 1 of each bond).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reforge.forge.topology.BondList.comms">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">comms</span></span><a class="headerlink" href="#reforge.forge.topology.BondList.comms" title="Link to this definition"></a></dt>
<dd><p>Get comments from each bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of comments (index 2 of each bond).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="reforge.forge.topology.BondList.measures">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">measures</span></span><a class="headerlink" href="#reforge.forge.topology.BondList.measures" title="Link to this definition"></a></dt>
<dd><p>Get measure values from each bond.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of measures extracted from the second element of the bond parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.BondList.categorize">
<span class="sig-name descname"><span class="pre">categorize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#BondList.categorize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.BondList.categorize" title="Link to this definition"></a></dt>
<dd><p>Categorize bonds based on their comments.</p>
<dl class="simple">
<dt>Description:</dt><dd><p>Uses the stripped comment (index 2) as a key to group bonds into a dictionary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A dictionary mapping each unique comment to a BondList of bonds.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.BondList.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bycomm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#BondList.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.BondList.filter" title="Link to this definition"></a></dt>
<dd><p>Filter bonds based on a provided condition.</p>
<dl class="simple">
<dt>Description:</dt><dd><p>Selects bonds for which the condition (a callable) returns True.
By default, the condition is applied to the comment field.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condition</strong> (<em>callable</em>) – A function that takes a bond (or its comment) as input and returns True if the bond should be included.</p></li>
<li><p><strong>bycomm</strong> (<em>bool, optional</em>) – If True, the condition is applied to the comment (default is True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new BondList containing the bonds that meet the condition.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reforge.forge.topology.BondList" title="reforge.forge.topology.BondList">BondList</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">reforge.forge.topology.</span></span><span class="sig-name descname"><span class="pre">Topology</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">forcefield</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sequence</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secstruct</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Topology Class</p>
<dl class="simple">
<dt>Description:</dt><dd><p>Constructs a coarse-grained topology from force field parameters.
Provides methods for processing atoms, bonds, and connectivity, and for
generating a topology file for coarse-grained simulations.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Variables<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ff</strong> (<em>object</em>) – Force field instance.</p></li>
<li><p><strong>sequence</strong> (<em>list</em>) – List of residue names.</p></li>
<li><p><strong>name</strong> (<em>str</em>) – Molecule name.</p></li>
<li><p><strong>nrexcl</strong> (<em>int</em>) – Exclusion parameter.</p></li>
<li><p><strong>atoms</strong> (<em>list</em>) – List of atom records.</p></li>
<li><p><strong>elnet</strong> (<em>bonds</em><em>, </em><em>angles</em><em>, </em><em>dihs</em><em>, </em><em>cons</em><em>, </em><em>excls</em><em>, </em><em>pairs</em><em>, </em><em>vs3s</em><em>, </em><em>posres</em><em>,</em>) – BondList instances for various bonded interactions.</p></li>
<li><p><strong>blist</strong> (<em>list</em>) – List containing all bond-type BondLists.</p></li>
<li><p><strong>secstruct</strong> (<em>list</em>) – Secondary structure as a list of characters.</p></li>
<li><p><strong>natoms</strong> (<em>int</em>) – Total number of atoms.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.lines">
<span class="sig-name descname"><span class="pre">lines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.lines" title="Link to this definition"></a></dt>
<dd><p>Generate the topology file as a list of lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of strings, each representing a line in the topology file.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.write_to_itp">
<span class="sig-name descname"><span class="pre">write_to_itp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.write_to_itp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.write_to_itp" title="Link to this definition"></a></dt>
<dd><p>Write the topology to an ITP file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – The output file path.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.process_atoms">
<span class="sig-name descname"><span class="pre">process_atoms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_resid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.process_atoms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.process_atoms" title="Link to this definition"></a></dt>
<dd><p>Process atoms based on the sequence and force field definitions.</p>
<dl class="simple">
<dt>Description:</dt><dd><p>For each residue in the sequence, constructs atom records using both
backbone and sidechain definitions from the force field.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_atom</strong> (<em>int, optional</em>) – Starting atom ID (default is 0).</p></li>
<li><p><strong>start_resid</strong> (<em>int, optional</em>) – Starting residue ID (default is 1).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.process_bb_bonds">
<span class="sig-name descname"><span class="pre">process_bb_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_resid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.process_bb_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.process_bb_bonds" title="Link to this definition"></a></dt>
<dd><p>Process backbone bonds using force field definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_atom</strong> (<em>int, optional</em>) – Starting atom ID.</p></li>
<li><p><strong>start_resid</strong> (<em>int, optional</em>) – Starting residue ID.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.process_sc_bonds">
<span class="sig-name descname"><span class="pre">process_sc_bonds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">start_atom</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start_resid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.process_sc_bonds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.process_sc_bonds" title="Link to this definition"></a></dt>
<dd><p>Process sidechain bonds using force field definitions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>start_atom</strong> (<em>int, optional</em>) – Starting atom ID.</p></li>
<li><p><strong>start_resid</strong> (<em>int, optional</em>) – Starting residue ID.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.elastic_network">
<span class="sig-name descname"><span class="pre">elastic_network</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atoms</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anames</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">el</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ef</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">200</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.elastic_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.elastic_network" title="Link to this definition"></a></dt>
<dd><p>Construct an elastic network between selected atoms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atoms</strong> (<em>list</em>) – List of atom objects.</p></li>
<li><p><strong>anames</strong> (<em>list of str, optional</em>) – Atom names to include (default: [“BB1”, “BB3”]).</p></li>
<li><p><strong>el</strong> (<em>float, optional</em>) – Lower distance cutoff.</p></li>
<li><p><strong>eu</strong> (<em>float, optional</em>) – Upper distance cutoff.</p></li>
<li><p><strong>ef</strong> (<em>float, optional</em>) – Force constant.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.from_sequence">
<span class="sig-name descname"><span class="pre">from_sequence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sequence</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secstruc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.from_sequence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.from_sequence" title="Link to this definition"></a></dt>
<dd><p>Build topology from a given sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sequence</strong> (<em>list</em>) – Nucleic acid sequence (list of residue names).</p></li>
<li><p><strong>secstruc</strong> (<em>list, optional</em>) – Secondary structure. If not provided, defaults to all ‘F’.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.from_chain">
<span class="sig-name descname"><span class="pre">from_chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">secstruc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.from_chain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.from_chain" title="Link to this definition"></a></dt>
<dd><p>Build topology from a chain instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chain</strong> (<em>object</em>) – Chain object containing residues.</p></li>
<li><p><strong>secstruc</strong> (<em>list, optional</em>) – Secondary structure.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="reforge.forge.topology.Topology.merge_topologies">
<em class="property"><span class="k"><span class="pre">static</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">merge_topologies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">topologies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/reforge/forge/topology.html#Topology.merge_topologies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#reforge.forge.topology.Topology.merge_topologies" title="Link to this definition"></a></dt>
<dd><p>Merge multiple Topology instances into one.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>topologies</strong> (<em>list</em>) – List of Topology objects.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A merged Topology instance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#reforge.forge.topology.Topology" title="reforge.forge.topology.Topology">Topology</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-reforge.forge">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-reforge.forge" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="reforge.html" class="btn btn-neutral float-left" title="reforge package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reforge.martini.html" class="btn btn-neutral float-right" title="reforge.martini package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Danis Yangaliev.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>